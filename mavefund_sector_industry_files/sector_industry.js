const isMobileScreen=window.innerWidth<=768;var previousScrollTop=0;const initializeSectors=()=>{let e=document.querySelectorAll(".sector"),t=document.querySelectorAll(".sector ul li"),n=0,l=0,r=()=>{e.forEach(e=>{let t=e.querySelector("ul");t&&t.classList.remove("show")})},a=()=>{t.forEach(e=>{e.classList.remove("nav-selected")})},i=e=>{if(e<0||e>=t.length)return;let n=t[e],l=n.parentElement;r(),a(),l.classList.add("show"),n.classList.add("nav-selected"),n.scrollIntoView({behavior:"smooth",block:"nearest"}),n.click()},s=e=>{let l=e.target.nextElementSibling;if(r(),a(),l){l.classList.add("show");let i=l.querySelector("li");i&&(i.classList.add("nav-selected"),n=Array.from(t).indexOf(i))}},o=e=>{a(),e.target.classList.add("nav-selected"),n=Array.from(t).indexOf(e.target)},c=e=>{e.preventDefault();let t=Date.now();if(t-l<100)return;l=t;let n=e.deltaY>0?1:-1;p(n)},d=e=>{e.preventDefault();let t=Date.now();if(t-l<100)return;l=t;let n=document.querySelector(".sector-content-wrapper");n.scrollTop<previousScrollTop&&0===n.scrollTop&&p(0),n.scrollTop>previousScrollTop&&n.scrollTop+n.clientHeight>=n.scrollHeight&&(p(1),n.scrollTop=0),previousScrollTop=n.scrollTop},p=e=>{let l=t[n],r=l.parentElement;if(1===e){if(n<t.length-1)n++;else{let a=r.nextElementSibling;if(a){let s=a.querySelectorAll("li");s.length>0&&(n=Array.from(t).indexOf(s[0]))}}}else if(n>0)n--;else{let o=r.previousElementSibling;if(o){let c=o.querySelectorAll("li");c.length>0&&(n=Array.from(t).indexOf(c[c.length-1]))}}i(n)},m=()=>{let l=e[0],r=l.querySelector("ul"),a=r.querySelector("li");r.classList.add("show"),a.classList.add("nav-selected"),n=0,e.forEach(e=>{let t=e.querySelector("h2");t.addEventListener("click",s)}),t.forEach(e=>{e.addEventListener("click",o)})};if(m(),isMobileScreen){let h=document.querySelector(".content-container");h.addEventListener("touchend",d);let g=document.getElementById("toggleIcon"),y=document.querySelector(".sector-index");g&&g.addEventListener("touchend",function(e){y.classList.contains("show")?y.classList.remove("show"):y.classList.add("show")})}else document.querySelector(".content-container").addEventListener("wheel",c,{passive:!1})};function onSectorMounted(){initializeSectors()}function observeSectors(){let e=new MutationObserver((e,t)=>{for(let n of e)if(n.addedNodes.length){for(let l of n.addedNodes)if(l.classList&&l.classList.contains("sector")){console.log("sector mounted"),onSectorMounted(),t.disconnect();return}}});e.observe(document.body,{childList:!0,subtree:!0})}function updateCompanyInfo(e){if(e&&e.length>0){let t=e[0];document.getElementById("name-placeholder").textContent=t.company_name,document.getElementById("sector-placeholder").textContent=t.sector,document.getElementById("industry-placeholder").textContent=t.industry,document.getElementById("stars").setAttribute("data-star",t.rating),document.getElementById("companyname-placeholder").textContent=t.company_name,document.getElementById("ticker-placeholder").innerHTML=`<a href="https://mavefund.com/company?key=${t.ticker}">${t.ticker}</a>`,document.getElementById("full-description").textContent=t.description,document.getElementById("item-description").innerHTML=`${t.company_name} has been evaluated based on its fundamentals over the past five years. 
      Companies with high ratings typically demonstrate growing earnings, substantial profit margins, conservative leverage, 
      consistently high returns on equity, and a sustained practice of share repurchases.`,document.getElementById("item-growth").innerHTML=`Over the last five years, ${t.company_name} has achieved an average annual return of ${t.avg_last_five}%. This year, 
      it holds the highest rating in its industry.`,createRadarchart(t.ticker,"radarChart","tooltip"),addStarsFromData(),initialDescription();let n=t.market_cap;n>=1e6?document.getElementById("marketcap-placeholder").textContent=(n/1e6).toFixed(2)+" trillion":n>=1e3?document.getElementById("marketcap-placeholder").textContent=(n/1e3).toFixed(2)+" billion":document.getElementById("marketcap-placeholder").textContent=n+" million",document.getElementById("avggrowth5y-placeholder").textContent=t.avg_last_five}else console.error("Error fetching company data.")}function addStarsFromData(){let e=document.getElementById("stars"),t=parseFloat(e.getAttribute("data-star"))||0;e.innerHTML="",t<1&&(t=1),mod_value=(mod_value=t%1).toFixed(2);let n=Math.floor(t),l=mod_value>=.25&&mod_value<=.7,r=mod_value>=.71;for(let a=0;a<n;a++){let i=document.createElement("img");i.src="/static/image/star/star_filled_icon_200260_gold.png",e.appendChild(i)}if(l){let s=document.createElement("img");s.src="/static/image/star/star_one_quarter_filled_icon_199689_gold.png",e.appendChild(s)}if(r){let o=document.createElement("img");o.src="/static/image/star/star_three_quarter_filled_icon_200261_gold.png",e.appendChild(o)}let c=5-(n+(l?1:0)+(r?1:0));for(let d=0;d<c;d++){let p=document.createElement("img");p.src="/static/image/star/gold-star.png",e.appendChild(p)}let m=document.createElement("span");m.textContent=t+"/5",m.classList.add("rating-text"),e.appendChild(m)}function fetchDataFromAPI(e,t){let n=`https://mavefund.com/api/v1/info/get_sector_industry_detail?sector=${encodeURIComponent(e)}&industry=${encodeURIComponent(t)}`;fetch(n).then(e=>e.json()).then(e=>updateCompanyInfo(e)).catch(e=>console.error("Error fetching data:",e))}function toggleDescription(){var e=document.getElementById("full-description"),t=document.getElementById("short-description"),n=document.getElementById("read-more");"none"===e.style.display?(e.style.display="inline",t.style.display="none",n.innerHTML="Read Less"):(e.style.display="none",t.style.display="inline",n.innerHTML="Read More")}function initialDescription(){var e=document.getElementById("full-description"),t=document.getElementById("short-description"),n=document.getElementById("read-more");if(e&&t&&n){var l=e.innerText;l.length>300?(t.innerText=l.substring(0,300)+" ...",e.style.display="none",t.style.display="inline",n.style.display="inline"):n.style.display="none"}}document.addEventListener("DOMContentLoaded",async()=>{observeSectors();let e=document.getElementById("sectors-container"),t=[],n=[];try{let l=await fetch("https://mavefund.com/api/v1/info/get_sector_industry"),r=await l.json();n=(t=Object.keys(r)).map(e=>r[e]);let a,i,s;for(let o of Object.keys(r)){let c=document.createElement("div");c.classList.add("sector");let d=document.createElement("h2");d.textContent=o;let p=document.createElement("ul");p.classList.add("industry-list"),s||(s=d),document.getElementById("toggleIcon"),r[o].forEach((e,t)=>{let n=document.createElement("li");n.textContent=e,p.appendChild(n),n.addEventListener("click",()=>{fetchDataFromAPI(o,e);let t=document.querySelector(".nav-selected");t&&t.classList.remove("nav-selected"),n.classList.add("nav-selected");let l=document.querySelector(".sector-index");l.classList.remove("show")}),0!==t||i||(a=o,i=e,n.classList.add("nav-selected"))}),c.appendChild(d),c.appendChild(p),d.addEventListener("click",()=>{let e=document.querySelector(".industry-list.show");e&&e!==p&&e.classList.remove("show"),p.classList.toggle("show")}),e.appendChild(c)}s&&s.click(),a&&i&&fetchDataFromAPI(a,i)}catch(m){let h=document.createElement("p");h.textContent="Error fetching data. Please try again later.",e.appendChild(h)}});